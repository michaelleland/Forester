<div id="entry_form">
	<form action="/add_ticket_entry_row" method="post" data-remote="true">
		<h4>New Entry</h4>
		<table id="entry_table">
			<tr>
				<th>Ticket #</th>
				<th>Date</th>
				<th>Job</th>
				<th>Destination</th>
				<th>Wood type</th>
				<th>Load type</th>
				<th>Species</th>
				<th>Tonnage</th>
				<th>MBF</th>
				<th>Net MBF</th>
				<th>Load pay</th>
				<th>Action</th>
			</tr>
			<tr>
				<td>
					<input id="ticket_num" type="text" name="ticket_num" size="5" class="fields"/>
					<script>$('#ticket_num').mask('9999', {placeholder: " "})</script>
				</td>
				<td>
					<input type="text" name="delivery_date" id="delivery_date" size="8" class="fields"/>
					<script> $('#delivery_date').datepicker({ dateFormat: 'yy-mm-dd'}); $('#delivery_date').mask("9999-99-99", {placeholder: " "}); </script>
				</td>
				<td>
					<input type="text" id="job_name" name="job_name" size="12" class="fields"/>
					<script> 
						$(function() {
							var jobs = [
								<% @jobs.each do |i| %>
									<%= "'#{i.name}'," %>
								<% end %>
							];
													
							$('#job_name').autocomplete({ 
								source: jobs,
								delay: 50,
								autoFocus: true
							});
						});
					</script>
				</td>
				<td>
					<input type="text" id="destination_name" name="destination_name" size="15" class="fields" />
					<script> 
						$(function() {
							var destinations = [
								<% @destinations.each do |i| %>
									<%= "'#{i.name}'," %>
								<% end %>
							];
													
							$('#destination_name').autocomplete({ 
								source: destinations,
								delay: 50,
								autoFocus: true
							});
						});
					</script>
				</td>
				<td>
					<select onchange="check_load_type();" name="wood_type">
						<% WoodType.all.each do |i| %>
							<option value="<%= i.id %>"><%= i.name %></option>
						<% end %>					
					</select>
				</td>
				<td>
					<select name="load_type">
						<option value="MBF">MBF</option>
						<option value="Tonnage">Tonnage</option>
					</select>
				</td>
				<td>
					<select class="specie_selector" name="species_1">
						<% Specie.all.each do |i| %>
							<option value="<%= i.id %>"><%= i.code %></option>
						<% end %>
						<option value="0">Pulp</option>
					</select>
				</td>
				<td>
					<input type="text" size="8" name="tonnage" class="fields"/>
				</td>
				<td>
					<input id="load_1_mbf" type="text" size="8" onchange="refresh_net_mbf('load_1_mbf')" name="load_1_mbf" class="fields"/>
				</td>
				<td>
					<input id="net_mbf" type="text" size="8" value="0" name="net_mbf" disabled="disabled" class="fields"/>
				</td>
				<td>
					<input type="text" size="8" name="value" class="fields"/>
				</td>
				<td>
					<input type="submit" value="Submit" />
				</td>
			</tr>
			<tr id="filler_row">
				<td id="Incredible_invisible_text">You</td>
				<td id="Incredible_invisible_text">have</td>
				<td id="Incredible_invisible_text">just</td>	
				<td id="Incredible_invisible_text">been</td>
				<td id="Incredible_invisible_text">tagged</td>
				<td id="Incredible_invisible_text">by ME!</td>
				<td><%= link_to "Add", {:controller => "page_controls", :action => "add_specie"}, :remote => true, :id => "add_specie_button"%></td>			
			</tr>
		</table>
	</form>
</div>

<div id="current_entries">
	<h4>Current Entries</h4>
	
	<table>
		<tr>
			<th style="width: 50px;">Ticket #</th>
			<th style="width: 80px;">Date</th>
			<th style="width: 100px;">Job</th>
			<th style="width: 100px;">Destination</th>
			<th style="width: 80px;">Wood type</th>
			<th style="width: 60px;">Load type</th>
			<th style="width: 60px;">Species</th>
			<th style="width: 60px;">Net MBF</th>
			<th style="width: 60px;">Tonnage</th>
			<th style="width: 80px;">Load pay</th>
			<th style="width: 40px;">Action</th>
		</tr>
		
	</table>
	
</div>

<div id="all_entries">
	<h4>All Entries</h4>
	<table>
		<tr>
			<th style="width: 50px;">Ticket #</th>
			<th style="width: 80px;">Date</th>
			<th style="width: 100px;">Job</th>
			<th style="width: 100px;">Destination</th>
			<th style="width: 80px;">Wood type</th>
			<th style="width: 60px;">Load type</th>
			<th style="width: 60px;">Species</th>
			<th style="width: 60px;">Net MBF</th>
			<th style="width: 60px;">Tonnage</th>
			<th style="width: 80px;">Load pay</th>
			<th style="width: 40px;">Action</th>
		</tr>
		
	</table>

	
	<script>
		refresh_all_entries('ticket');
		
		function refresh_net_mbf(where_from) {
			amount = 0;
			
			<% Specie.all.each do |i| %>
				if (String(parseFloat($('#load_'+<%= i.id %>+'_mbf').attr('value'))) != "NaN") {
					amount = amount + parseFloat($('#load_'+<%= i.id %>+'_mbf').attr('value'));
				}
			<% end %>
			
			$('#net_mbf').attr('value', amount);
		}
		
	</script>
</div>